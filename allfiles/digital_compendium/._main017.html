<!DOCTYPE HTML>
<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Numerical Methods for Engineers">

<title>Numerical Methods for Engineers</title>

<!-- Bootstrap style: bootstrap_bluegray -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_bootstrap/css/bootstrap_bluegray.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [(u' Initial value problems for Ordinary Differential Equations ',
               1,
               None,
               '___sec0'),
              (u' Introduction ',
               1,
               u'section:introduction',
               u'section:introduction'),
              (u" Taylor's method ", 2, u'sec:taylor', u'sec:taylor'),
              (u' Reduction of Higher order Equations ',
               2,
               u'subsec:reduction',
               u'subsec:reduction'),
              (u' Example 1: Reduction of higher order systems ',
               2,
               None,
               '___sec4'),
              (u' Scientific computing with Python ', 2, None, '___sec5'),
              (u' Example 2: Sphere in free fall ',
               2,
               u'example:sphere_freefall',
               u'example:sphere_freefall'),
              (u' Python implementation of the drag coefficient function and how to plot it ',
               3,
               None,
               '___sec7'),
              (u' Python functions with vector arguments and modules ',
               2,
               None,
               '___sec8'),
              (u' How to make a Python-module and some useful programming features ',
               2,
               u'section:Python_module',
               u'section:Python_module'),
              (u' Differences ', 2, None, '___sec10'),
              (u' Treatment of the term $\\frac{d}{dx} \\left[ p(x) \\frac{d}{dx} u(x)\\right]$ ',
               3,
               None,
               '___sec11'),
              (u" Euler's method ",
               2,
               u'ex:euler_method',
               u'ex:euler_method'),
              (u' Example 3: Falling sphere with constant and varying drag ',
               2,
               u'ex:falling_sphere',
               u'ex:falling_sphere'),
              (u' Example 4: Numerical error as a function of $\\Delta t$ ',
               2,
               None,
               '___sec14'),
              (u" Euler's method for a system ", 3, None, '___sec15'),
              (u" Heun's method ", 2, None, '___sec16'),
              (u" Example 5: Newton's equation ", 2, None, '___sec17'),
              (u" Example 6: Falling sphere with Heun's method ",
               2,
               None,
               '___sec18'),
              (u' Runge-Kutta of 4th order ', 2, None, '___sec19'),
              (u' Example 7: Particle motion in two dimensions ',
               2,
               None,
               '___sec20'),
              (u' Example 8: Numerical error as  a function of $\\Delta t$ for ODE-schemes ',
               2,
               None,
               '___sec21')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="main.html">Numerical Methods for Engineers</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._main000.html#___sec0" style="font-size: 80%;">Initial value problems for Ordinary Differential Equations</a></li>
     <!-- navigation toc: --> <li><a href="._main001.html#section:introduction" style="font-size: 80%;">Introduction</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0017"></a>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._main016.html">&laquo;</a></li>
  <li><a href="._main000.html">1</a></li>
  <li><a href="">...</a></li>
  <li><a href="._main009.html">10</a></li>
  <li><a href="._main010.html">11</a></li>
  <li><a href="._main011.html">12</a></li>
  <li><a href="._main012.html">13</a></li>
  <li><a href="._main013.html">14</a></li>
  <li><a href="._main014.html">15</a></li>
  <li><a href="._main015.html">16</a></li>
  <li><a href="._main016.html">17</a></li>
  <li class="active"><a href="._main017.html">18</a></li>
</ul>
<!-- !split -->

<p>
<!-- --- begin exercise --- -->

<h2 id="___sec21">Example 8: Numerical error as  a function of \( \Delta t \) for ODE-schemes </h2>

<p>
To investigate whether our implementation of the various ODE-schemes
have the expected, theoretical order, we proceed in the same manner as
outlined in a previous example. The complete code is listed at the end
of this section but we will highlight and explain some details in the
following.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_convergence</span>():
        <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot; Test convergence rate of the methods &quot;&quot;&quot;</span>
        <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">import</span> linspace, size, <span style="color: #008000">abs</span>, log10, mean
        figure()
        tol <span style="color: #666666">=</span> <span style="color: #666666">1E-15</span>
        T <span style="color: #666666">=</span> <span style="color: #666666">8.0</span>   <span style="color: #408080; font-style: italic"># end of simulation</span>
        Ndts <span style="color: #666666">=</span> <span style="color: #666666">5</span> <span style="color: #408080; font-style: italic"># Number of times to refine timestep in convergence test</span>

        z0 <span style="color: #666666">=</span> <span style="color: #666666">2</span>

<span style="color: #408080; font-style: italic">#        scheme_list  = [euler, euler2, euler3, euler4, heun, heun2, rk4]</span>
        scheme_list <span style="color: #666666">=</span>[euler, heun, rk4]
        legends<span style="color: #666666">=</span>[]
        all_errors<span style="color: #666666">=</span>{}
        
        <span style="color: #008000; font-weight: bold">for</span> scheme <span style="color: #AA22FF; font-weight: bold">in</span> scheme_list:
            N <span style="color: #666666">=</span> <span style="color: #666666">30</span>    <span style="color: #408080; font-style: italic"># no of time steps</span>
            time <span style="color: #666666">=</span> linspace(<span style="color: #666666">0</span>, T, N<span style="color: #666666">+1</span>)

            error_diff <span style="color: #666666">=</span> []
            <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(Ndts<span style="color: #666666">+1</span>):
                z <span style="color: #666666">=</span> scheme(f3,z0,time)   
                abs_error <span style="color: #666666">=</span> <span style="color: #008000">abs</span>(u_nonlin_analytical(z0, time)<span style="color: #666666">-</span>z[:,<span style="color: #666666">0</span>])
                log_error <span style="color: #666666">=</span> log10(abs_error[<span style="color: #666666">1</span>:]) <span style="color: #408080; font-style: italic"># Drop first element as it is always zero to avoid log10-problems </span>
                max_log_err <span style="color: #666666">=</span> <span style="color: #008000">max</span>(log_error)
                plot(time[<span style="color: #666666">1</span>:], log_error)
                legends<span style="color: #666666">.</span>append(scheme<span style="color: #666666">.</span>func_name <span style="color: #666666">+</span><span style="color: #BA2121">&#39;: N = &#39;</span> <span style="color: #666666">+</span> <span style="color: #008000">str</span>(N))
                hold(<span style="color: #BA2121">&#39;on&#39;</span>)
                
                <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">&gt;</span> <span style="color: #666666">0</span>: <span style="color: #408080; font-style: italic"># Compute the log10 error difference</span>
                    error_diff<span style="color: #666666">.</span>append(previous_max_log_err<span style="color: #666666">-</span>max_log_err) 
                previous_max_log_err <span style="color: #666666">=</span> max_log_err
                
                
                N <span style="color: #666666">*=2</span>
                time <span style="color: #666666">=</span> linspace(<span style="color: #666666">0</span>, T, N<span style="color: #666666">+1</span>)
                
            all_errors[scheme<span style="color: #666666">.</span>func_name]<span style="color: #666666">=</span>error_diff
            <span style="color: #408080; font-style: italic">#print error_diff</span>
            <span style="color: #408080; font-style: italic">#print mean(error_diff), 10**(mean(error_diff)), error_diff</span>
            <span style="color: #008000; font-weight: bold">print</span> <span style="color: #666666">10**</span>np<span style="color: #666666">.</span>asarray(error_diff)

        legend(legends, loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;best&#39;</span>)
        
        N <span style="color: #666666">=</span> N<span style="color: #666666">/2**</span>Ndts
        N_list <span style="color: #666666">=</span> [N<span style="color: #666666">*2**</span>i <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>,Ndts<span style="color: #666666">+1</span>)]
        N_list <span style="color: #666666">=</span> np<span style="color: #666666">.</span>asarray(N_list)
        <span style="color: #008000; font-weight: bold">print</span> N_list         
        
        figure()
        <span style="color: #008000; font-weight: bold">for</span> key <span style="color: #AA22FF; font-weight: bold">in</span> all_errors:
            plot(N_list,<span style="color: #666666">10**</span>(np<span style="color: #666666">.</span>asarray(all_errors[key])))
        
        <span style="color: #408080; font-style: italic"># Plot theoretical error reductions for first, second and fourth order schemes</span>
        axhline(<span style="color: #666666">2.0</span>, xmin<span style="color: #666666">=0</span>, xmax<span style="color: #666666">=</span>N,linestyle<span style="color: #666666">=</span><span style="color: #BA2121">&#39;:&#39;</span>)
        axhline(<span style="color: #666666">4.0</span>, xmin<span style="color: #666666">=0</span>, xmax<span style="color: #666666">=</span>N,linestyle<span style="color: #666666">=</span><span style="color: #BA2121">&#39;:&#39;</span>)
        axhline(<span style="color: #666666">16.0</span>, xmin<span style="color: #666666">=0</span>, xmax<span style="color: #666666">=</span>N,linestyle<span style="color: #666666">=</span><span style="color: #BA2121">&#39;:&#39;</span>)
        xticks(N_list)
        legends <span style="color: #666666">=</span>all_errors<span style="color: #666666">.</span>keys()
        legends<span style="color: #666666">.</span>append(<span style="color: #BA2121">&#39;theoretical&#39;</span>) 
        legend(legends,loc<span style="color: #666666">=</span><span style="color: #BA2121">&#39;best&#39;</span>)
        xlabel(<span style="color: #BA2121">&#39;Number of unknowns&#39;</span>)
        ylabel(<span style="color: #BA2121">&#39;Error reduction when reducing timestep by two&#39;</span>)
</pre></div>
<p>
<!-- begin bibliography -->

<ol>
 <li> <div id="hairer2008solving"></div> <b>E. Hairer, S. P. Norsett and G. Wanner</b>. 
    <em>Solving Ordinary Differential Equations I: Nonstiff Problems</em>,
    Springer Science &amp; Business,
    2008.</li>
 <li> <div id="white1999fluid"></div> <b>F. White</b>. 
    <em>Fluid Mechanics</em>,
    WCB/McGraw-Hill,
    1999,
    <a href="http://books.google.no/books/about/Fluid_mechanics.html?id=fa_pAAAAMAAJ&redir_esc=y" target="_blank"><tt>http://books.google.no/books/about/Fluid_mechanics.html?id=fa_pAAAAMAAJ&redir_esc=y</tt></a>.</li>
 <li> <div id="evett19892"></div> <b>J. Evett and C. Liu</b>. 
    <em>2,500 Solved Problems in Fluid Mechanics and Hydraulics</em>,
    McGraw-Hill Education,
    1989,
    <a href="http://books.google.no/books?id=NBDjWHLKwSQC" target="_blank"><tt>http://books.google.no/books?id=NBDjWHLKwSQC</tt></a>.</li>
 <li> <div id="langtangen14"></div> <b>H. P. Langtangen</b>. 
    <em>A Primer on Scientific Programming With Python</em>,
    Springer,
    2014.</li>
 <li> <div id="python14"></div> <b>S. F. Python</b>. 
    <em>The Python Tutorial</em>,
    Python Software Foundation,
    2014.</li>
 <li> <div id="cheney2012numerical"></div> <b>E. Cheney and D. Kincaid</b>. 
    <em>Numerical Mathematics and Computing</em>,
    Cengage Learning,
    2012.</li>
 <li> <div id="Bearman1976112"></div> <b>P. Bearman and J. Harvey</b>. 
    GOLF BALL AERODYNAMICS.,
    <em>Aeronaut Q</em>,
    27(pt 2),
    pp. 112-122,
    1976,
    <a href="http://www.scopus.com/inward/record.url?eid=2-s2.0-0016949854&partnerID=40&md5=a1d1cc6e8477e33fcd2d5ccf55fc29a8" target="_blank"><tt>http://www.scopus.com/inward/record.url?eid=2-s2.0-0016949854&partnerID=40&md5=a1d1cc6e8477e33fcd2d5ccf55fc29a8</tt></a>.</li>
</ol>

<!-- end bibliography -->

<p>
<!-- --- end exercise --- -->

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._main016.html">&laquo;</a></li>
  <li><a href="._main000.html">1</a></li>
  <li><a href="">...</a></li>
  <li><a href="._main009.html">10</a></li>
  <li><a href="._main010.html">11</a></li>
  <li><a href="._main011.html">12</a></li>
  <li><a href="._main012.html">13</a></li>
  <li><a href="._main013.html">14</a></li>
  <li><a href="._main014.html">15</a></li>
  <li><a href="._main015.html">16</a></li>
  <li><a href="._main016.html">17</a></li>
  <li class="active"><a href="._main017.html">18</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

