<!DOCTYPE HTML>
<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="TKT4140 Numerical Methods for Engineers">

<title>TKT4140 Numerical Methods for Engineers</title>

<!-- Bootstrap style: bootstrap_bluegray -->
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_bootstrap/css/bootstrap_bluegray.css" rel="stylesheet">
<!-- not necessary
<link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->


</head>

<!-- tocinfo
{'highest level': 0,
 'sections': [(u' Initial value problems for Ordinary Differential Equations ',
               0,
               None,
               '___sec0'),
              (u' Introduction ',
               1,
               u'section:introduction',
               u'section:introduction'),
              (u" Taylor's method ", 2, u'sec:taylor', u'sec:taylor'),
              (u' Reduction of Higher order Equations ',
               2,
               u'subsec:reduction',
               u'subsec:reduction'),
              (u' Example 1: Reduction of higher order systems ',
               2,
               None,
               '___sec4'),
              (u' Scientific computing with Python ', 2, None, '___sec5'),
              (u' Example 2: Sphere in free fall ',
               2,
               u'example:sphere_freefall',
               u'example:sphere_freefall'),
              (u' Python implementation of the drag coefficient function and how to plot it ',
               3,
               None,
               '___sec7'),
              (u' Python functions with vector arguments and modules ',
               2,
               None,
               '___sec8'),
              (u' How to make a Python-module and some useful programming features ',
               2,
               u'section:Python_module',
               u'section:Python_module'),
              (u' Differences ', 2, None, '___sec10'),
              (u' Treatment of the term $\\frac{d}{dx} \\left[ p(x) \\frac{d}{dx} u(x)\\right]$ ',
               3,
               None,
               '___sec11'),
              (u" Euler's method ", 2, None, '___sec12'),
              (u' Example 3: Falling sphere with constant and varying drag ',
               2,
               u'ex:falling_sphere',
               u'ex:falling_sphere'),
              (u" Euler's method for a system ", 3, None, '___sec14'),
              (u" Heun's method ", 2, None, '___sec15'),
              (u" Example 4: Newton's equation ", 2, None, '___sec16'),
              (u" Example 5: Falling sphere with Heun's method ",
               2,
               None,
               '___sec17'),
              (u' Runge-Kutta of 4th order ', 2, None, '___sec18'),
              (u' Example 6: Particle motion in two dimensions ',
               2,
               None,
               '___sec19')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="main.html">TKT4140 Numerical Methods for Engineers</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._main001.html#___sec0" style="font-size: 80%;"><b>Initial value problems for Ordinary Differential Equations</b></a></li>
     <!-- navigation toc: --> <li><a href="._main001.html#section:introduction" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Introduction</a></li>
     <!-- navigation toc: --> <li><a href="#sec:taylor" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Taylor's method</a></li>
     <!-- navigation toc: --> <li><a href="._main003.html#subsec:reduction" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reduction of Higher order Equations</a></li>
     <!-- navigation toc: --> <li><a href="._main003.html#___sec4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example 1: Reduction of higher order systems</a></li>
     <!-- navigation toc: --> <li><a href="._main003.html#___sec5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scientific computing with Python</a></li>
     <!-- navigation toc: --> <li><a href="._main004.html#example:sphere_freefall" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example 2: Sphere in free fall</a></li>
     <!-- navigation toc: --> <li><a href="._main005.html#___sec8" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Python functions with vector arguments and modules</a></li>
     <!-- navigation toc: --> <li><a href="._main005.html#section:Python_module" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;How to make a Python-module and some useful programming features</a></li>
     <!-- navigation toc: --> <li><a href="._main006.html#___sec10" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Differences</a></li>
     <!-- navigation toc: --> <li><a href="._main008.html#___sec12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Euler's method</a></li>
     <!-- navigation toc: --> <li><a href="._main009.html#ex:falling_sphere" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example 3: Falling sphere with constant and varying drag</a></li>
     <!-- navigation toc: --> <li><a href="._main011.html#___sec15" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Heun's method</a></li>
     <!-- navigation toc: --> <li><a href="._main012.html#___sec16" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example 4: Newton's equation</a></li>
     <!-- navigation toc: --> <li><a href="._main013.html#___sec17" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example 5: Falling sphere with Heun's method</a></li>
     <!-- navigation toc: --> <li><a href="._main014.html#___sec18" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Runge-Kutta of 4th order</a></li>
     <!-- navigation toc: --> <li><a href="._main015.html#___sec19" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example 6: Particle motion in two dimensions</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0002"></a>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._main001.html">&laquo;</a></li>
  <li><a href="._main000.html">1</a></li>
  <li><a href="._main001.html">2</a></li>
  <li class="active"><a href="._main002.html">3</a></li>
  <li><a href="._main003.html">4</a></li>
  <li><a href="._main004.html">5</a></li>
  <li><a href="._main005.html">6</a></li>
  <li><a href="._main006.html">7</a></li>
  <li><a href="._main007.html">8</a></li>
  <li><a href="._main008.html">9</a></li>
  <li><a href="._main009.html">10</a></li>
  <li><a href="._main010.html">11</a></li>
  <li><a href="._main011.html">12</a></li>
  <li><a href="">...</a></li>
  <li><a href="._main015.html">16</a></li>
  <li><a href="._main003.html">&raquo;</a></li>
</ul>
<!-- !split -->

<h2 id="sec:taylor">Taylor's method<a name="sec:taylor"></a></h2>
Taylor's formula for series expansion of a function \( f(x) \) around \( x_0 \) is given by
$$
\begin{equation}
f(x)=f(x_0)+(x-x_0)\cdot f'(x_0)+\frac{(x-x_0)^2}{2}f''(x_0)+\dots +\frac{(x-x_0)^n}{n !}f^{(n)}(x_0)+ \text{remainder} \nonumber
\end{equation}
$$

Let's use this formula to find the first terms in the series expansion for \( \theta(t) \) around \( t=0 \) from the differential equation given in <a href="._main001.html#mjx-eqn-7">(7)</a>:
$$
\begin{align*}
&\ddot{\theta} (t) +\theta (t) = 0 \\ 
&\theta (0) = \theta_0,\  \dot{\theta}(0)=0
\end{align*}
$$

We set \( \theta(t) \approx \theta(0)+t\cdot\dot{\theta}(0)+\frac{t^2}{2}\ddot\theta(0)+\frac{t^3}{6}\dddot\theta(0)+\frac{t^4}{24}\theta^{(4)}(0) \). By use of the initial conditions \( \theta(0)=\theta_0,\ \dot\theta(0)=0 \) we get
$$
\begin{equation}
\theta(t)\approx\theta_0 +\frac{t^2}{2}\ddot\theta+\frac{t^3}{6}\dddot\theta(0)+\frac{t^4}{24}\theta^{(4)}(0)  \nonumber
\end{equation}
$$

From the differential equation we have \( \ddot\theta(t)=-\theta(t)\to \ddot\theta(0)=-\theta(0)=-\theta_0 \)

<p>
By differentiation we get \( \dddot\theta(t)=-\dot\theta(t)\to \ddot\theta(0)=-\theta(0)=-\theta_0 \)

<p>
We now get
$$
\begin{equation}
\theta^{(4)}(t)=-\ddot\theta(t) \to \theta^{(4)}(0)=-\ddot\theta(0)=\theta_0 \nonumber
\end{equation}
$$

Setting this into the expression for \( \theta(t) \) gives \( \theta(t)\approx \theta_0\left(1-\frac{t^2}{2}+\frac{t^4}{24}\right)=\theta_0\left(1-\frac{t^2}{2!}+\frac{t^4}{4!}\right) \)

<p>
If we include \( n \) terms, we get
$$
\begin{equation}
\theta(t)\approx \theta_0\cdot \left(1-\frac{t^2}{2!}+\frac{t^4}{4!}-\frac{t^6}{6!}+\dots+(-1)^n \frac{t^{2n}}{(2n)!}\right) \nonumber
\end{equation}
$$


<p>
If we let \( n \to \infty \) we see that the parentheses give the series for \( \cos(t) \). In this case we have found the exact solution \( \theta(t)=\theta_0\cos(t) \) of the differential equation. Since this equation is linear we manage in this case to find a connection between the coefficients such that we recognize the series expansion of \( \cos(t) \).

<p>
Let's try the same procedure on the non-linear version <a href="._main001.html#mjx-eqn-5">(5)</a>
$$
\begin{align} \nonumber
\ddot{\theta}(t)& + \sin \left(\theta (t)\right) = 0 \\ 
\theta (0) &= \theta_0 ,\ \dot\theta (0) = 0 \nonumber
\end{align}
$$

We start in the same manner: \( \theta(t) \approx \theta(0)+\frac{t^2}{2}\ddot\theta(0)+\frac{t^3}{6}\dddot\theta(0)+\frac{t^4}{24}\theta^{(4)}(0) \).
From the differential equation we have \( \ddot\theta=-\sin (\theta) \to \ddot\theta(0)=-\sin(\theta_0) \), which by consecutive differentiation gives
$$
\begin{align}
&\dddot\theta=-\cos(\theta)\cdot\dot\theta \to \dddot\theta(0)=0 \nonumber \\ 
&\theta^{(4)}=\sin(\theta)\cdot\dot\theta^2-\cos(\theta)\cdot\ddot\theta \to \theta^{(4)}(0)=-\ddot\theta(0)\cos(\theta(0))=\sin(\theta_0)\cos(\theta_0) \nonumber
\end{align}
$$

Inserted above: \( \theta(t) \approx \theta_0 -\frac{t^2}{2}\sin(\theta_0) + \frac{t^4}{24} \sin (\theta_0) \cos (\theta_0) \).

<p>
We may include more terms, but this complicates the differentiation and it is hard to find any connection between the coefficients. When we have found an approximation for for \( \theta(t) \) we can get an approximation for \( \dot\theta(t) \) by differentiation: \( \dot\theta(t) \approx -t\sin(\theta_0) + \frac{t^3}{8} \sin (\theta_0) \cos (\theta_0) \).

<p>
Series expansions are often useful around the starting point when we solve initial value problems. The technique may also be used on non-linear equations.

<p>
Symbolic mathematical programs like <b>Maple</b> and <b>Mathematica</b> do this easily.

<p>
We will end with one of the earliest known differential equations, which Newton solved with series expansion in 1671.
$$
\begin{equation*}
y'(x) =1-3x+y+x^2+xy,\ y(0)=0
\end{equation*}
$$

Series expansion around \( x=0 \) gives
$$
\begin{equation*}
y(x) \approx x\cdot y'(0)+ \frac{x^2}{2} y''(0)+\frac{x^3}{6}y'''(0)+\frac{x^4}{24}y^{(4)}(0)
\end{equation*}
$$

From the differential equation we get \( y'(0)=1 \). By consecutive differentiation we get
$$
\begin{equation*}
  \begin{array}{lclclcr}
    y''(x) &=&-3+y'+2x+xy'+y &\to& y''(0)&=&-2\\ 
    y'''(x)&=& y''+2+xy''+2y'  &\to& y'''(0)&=& 2\\ 
    y^{(4)}(x)&=&y'''+xy'''+3y'' &\to &y^{(4)}(0)&=&-4
  \end{array}
\end{equation*}
$$

Inserting above gives \( y(x) \approx x-x^2+\frac{x^3}{3}-\frac{x^4}{6} \).

<p>
Newton gave the following solution: \( y(x) \approx  x-x^2+\frac{x^3}{3}-\frac{x^4}{6}+ \frac{x^5}{30}-\frac{x^6}{45} \).

<p>
Now you can check if Newton calculated correctly. Today it is possible to give the solution on closed form with known functions as follows,
$$
\begin{align*}
y(x)=&3\sqrt{2\pi e}\cdot \exp\left[x\left(1+\frac{x}{2}\right)\right]\cdot \left[\text{erf}\left(\frac{\sqrt{2}}{2}(1+x)\right)-\text{erf}\left(\frac{\sqrt{2}}{2}\right)\right]\\ 
+& 4\cdot\left[1-\exp[x\left(1+\frac{x}{2}\right)\right]-x
\end{align*}
$$


<p>
Note the combination \( \sqrt{2\pi e} \). See Hairer et al. <a href="._main015.html#hairer2008solving">[1]</a> section 1.2 for more details on classical differential equations.

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pagination">
<li><a href="._main001.html">&laquo;</a></li>
  <li><a href="._main000.html">1</a></li>
  <li><a href="._main001.html">2</a></li>
  <li class="active"><a href="._main002.html">3</a></li>
  <li><a href="._main003.html">4</a></li>
  <li><a href="._main004.html">5</a></li>
  <li><a href="._main005.html">6</a></li>
  <li><a href="._main006.html">7</a></li>
  <li><a href="._main007.html">8</a></li>
  <li><a href="._main008.html">9</a></li>
  <li><a href="._main009.html">10</a></li>
  <li><a href="._main010.html">11</a></li>
  <li><a href="._main011.html">12</a></li>
  <li><a href="">...</a></li>
  <li><a href="._main015.html">16</a></li>
  <li><a href="._main003.html">&raquo;</a></li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

